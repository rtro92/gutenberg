"use strict";(self.webpackChunkgutenberg=self.webpackChunkgutenberg||[]).push([[3900],{"./packages/compose/build-module/hooks/use-focusable-iframe/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>useFocusableIframe});var _use_ref_effect__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./packages/compose/build-module/hooks/use-ref-effect/index.js");function useFocusableIframe(){return(0,_use_ref_effect__WEBPACK_IMPORTED_MODULE_0__.Z)((element=>{const{ownerDocument}=element;if(!ownerDocument)return;const{defaultView}=ownerDocument;if(defaultView)return defaultView.addEventListener("blur",checkFocus),()=>{defaultView.removeEventListener("blur",checkFocus)};function checkFocus(){ownerDocument&&ownerDocument.activeElement===element&&element.focus()}}),[])}},"./packages/compose/build-module/hooks/use-merge-refs/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>useMergeRefs});var _wordpress_element__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js");function assignRef(ref,value){"function"==typeof ref?ref(value):ref&&ref.hasOwnProperty("current")&&(ref.current=value)}function useMergeRefs(refs){const element=(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_0__.useRef)(),isAttached=(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_0__.useRef)(!1),didElementChange=(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_0__.useRef)(!1),previousRefs=(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_0__.useRef)([]),currentRefs=(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_0__.useRef)(refs);return currentRefs.current=refs,(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_0__.useLayoutEffect)((()=>{!1===didElementChange.current&&!0===isAttached.current&&refs.forEach(((ref,index)=>{const previousRef=previousRefs.current[index];ref!==previousRef&&(assignRef(previousRef,null),assignRef(ref,element.current))})),previousRefs.current=refs}),refs),(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_0__.useLayoutEffect)((()=>{didElementChange.current=!1})),(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_0__.useCallback)((value=>{assignRef(element,value),didElementChange.current=!0,isAttached.current=null!==value;const refsToAssign=value?currentRefs.current:previousRefs.current;for(const ref of refsToAssign)assignRef(ref,value)}),[])}},"./packages/compose/build-module/hooks/use-ref-effect/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>useRefEffect});var _wordpress_element__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js");function useRefEffect(callback,dependencies){const cleanup=(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_0__.useRef)();return(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_0__.useCallback)((node=>{node?cleanup.current=callback(node):cleanup.current&&cleanup.current()}),dependencies)}},"./packages/components/src/sandbox/stories/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,default:()=>stories});var react=__webpack_require__("./node_modules/react/index.js"),serialize=__webpack_require__("./packages/element/build-module/serialize.js"),use_merge_refs=__webpack_require__("./packages/compose/build-module/hooks/use-merge-refs/index.js"),use_focusable_iframe=__webpack_require__("./packages/compose/build-module/hooks/use-focusable-iframe/index.js"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const observeAndResizeJS=function(){const{MutationObserver}=window;if(!MutationObserver||!document.body||!window.parent)return;function sendResize(){const clientBoundingRect=document.body.getBoundingClientRect();window.parent.postMessage({action:"resize",width:clientBoundingRect.width,height:clientBoundingRect.height},"*")}function removeViewportStyles(ruleOrNode){ruleOrNode.style&&["width","height","minHeight","maxHeight"].forEach((function(style){/^\\d+(vmin|vmax|vh|vw)$/.test(ruleOrNode.style[style])&&(ruleOrNode.style[style]="")}))}new MutationObserver(sendResize).observe(document.body,{attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0}),window.addEventListener("load",sendResize,!0),Array.prototype.forEach.call(document.querySelectorAll("[style]"),removeViewportStyles),Array.prototype.forEach.call(document.styleSheets,(function(stylesheet){Array.prototype.forEach.call(stylesheet.cssRules||stylesheet.rules,removeViewportStyles)})),document.body.style.position="absolute",document.body.style.width="100%",document.body.setAttribute("data-resizable-iframe-connected",""),sendResize(),window.addEventListener("resize",sendResize,!0)};function SandBox({html="",title="",type,styles=[],scripts=[],onFocus}){const ref=(0,react.useRef)(),[width,setWidth]=(0,react.useState)(0),[height,setHeight]=(0,react.useState)(0);function trySandBox(forceRerender=!1){if(!function isFrameAccessible(){try{return!!ref.current?.contentDocument?.body}catch(e){return!1}}())return;const{contentDocument,ownerDocument}=ref.current;if(!forceRerender&&null!==contentDocument?.body.getAttribute("data-resizable-iframe-connected"))return;const htmlDoc=(0,jsx_runtime.jsxs)("html",{lang:ownerDocument.documentElement.lang,className:type,children:[(0,jsx_runtime.jsxs)("head",{children:[(0,jsx_runtime.jsx)("title",{children:title}),(0,jsx_runtime.jsx)("style",{dangerouslySetInnerHTML:{__html:"\n\tbody {\n\t\tmargin: 0;\n\t}\n\thtml,\n\tbody,\n\tbody > div {\n\t\twidth: 100%;\n\t}\n\thtml.wp-has-aspect-ratio,\n\tbody.wp-has-aspect-ratio,\n\tbody.wp-has-aspect-ratio > div,\n\tbody.wp-has-aspect-ratio > div iframe {\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\toverflow: hidden; /* If it has an aspect ratio, it shouldn't scroll. */\n\t}\n\tbody > div > * {\n\t\tmargin-top: 0 !important; /* Has to have !important to override inline styles. */\n\t\tmargin-bottom: 0 !important;\n\t}\n"}}),styles.map(((rules,i)=>(0,jsx_runtime.jsx)("style",{dangerouslySetInnerHTML:{__html:rules}},i)))]}),(0,jsx_runtime.jsxs)("body",{"data-resizable-iframe-connected":"data-resizable-iframe-connected",className:type,children:[(0,jsx_runtime.jsx)("div",{dangerouslySetInnerHTML:{__html:html}}),(0,jsx_runtime.jsx)("script",{type:"text/javascript",dangerouslySetInnerHTML:{__html:`(${observeAndResizeJS.toString()})();`}}),scripts.map((src=>(0,jsx_runtime.jsx)("script",{src},src)))]})]});contentDocument.open(),contentDocument.write("<!DOCTYPE html>"+(0,serialize.ZP)(htmlDoc)),contentDocument.close()}return(0,react.useEffect)((()=>{function tryNoForceSandBox(){trySandBox(!1)}function checkMessageForResize(event){const iframe=ref.current;if(!iframe||iframe.contentWindow!==event.source)return;let data=event.data||{};if("string"==typeof data)try{data=JSON.parse(data)}catch(e){}"resize"===data.action&&(setWidth(data.width),setHeight(data.height))}trySandBox();const iframe=ref.current,defaultView=iframe?.ownerDocument?.defaultView;return iframe?.addEventListener("load",tryNoForceSandBox,!1),defaultView?.addEventListener("message",checkMessageForResize),()=>{iframe?.removeEventListener("load",tryNoForceSandBox,!1),defaultView?.addEventListener("message",checkMessageForResize)}}),[]),(0,react.useEffect)((()=>{trySandBox()}),[title,styles,scripts]),(0,react.useEffect)((()=>{trySandBox(!0)}),[html,type]),(0,jsx_runtime.jsx)("iframe",{ref:(0,use_merge_refs.Z)([ref,(0,use_focusable_iframe.Z)()]),title,className:"components-sandbox",sandbox:"allow-scripts allow-same-origin allow-presentation",onFocus,width:Math.ceil(width),height:Math.ceil(height)})}SandBox.displayName="SandBox";const sandbox=SandBox;const stories={component:sandbox,title:"Components/SandBox",argTypes:{onFocus:{control:{type:null}}},parameters:{sourceLink:"packages/components/src/sandbox",actions:{argTypesRegex:"^on.*"},controls:{expanded:!0},docs:{source:{state:"open"}}}},Template=args=>(0,jsx_runtime.jsx)(sandbox,{...args});Template.displayName="Template";const Default=Template.bind({});Default.args={html:"<p>Arbitrary HTML content</p>"}}}]);